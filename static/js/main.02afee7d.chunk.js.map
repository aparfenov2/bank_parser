{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["DateTime","require","DATE_FORMAT","valuetext","value","now","minus","days","toFormat","MinimumDistanceSlider","props","setValue","value2","map","_date","Math","round","fromFormat","diff","startOf","as","setValue2","day","React","useState","marks","setMarks","useEffect","fetchData","a","axios","result","data","ranges","d","label","Slider","getAriaLabel","min","max","onChange","event","newValue","activeThumb","Array","isArray","abs","clamped","onChangeCommitted","valueLabelDisplay","valueLabelFormat","disableSwap","ByDayTable","className","h","inx","row","r_inx","r","c_inx","v","com","dangerouslySetInnerHTML","__html","zip_longest","args","slice","call","arguments","longest","reduce","b","length","_","i","array","SummaryTable","row_row_c","inx_r","row_c","v_com","NavTable","onLinkClick","e","target","search","width","to","onClick","window","location","href","TabPanel","children","index","other","role","hidden","id","Box","a11yProps","PieChartPage","Object","entries","filter","k","parseFloat","data_by_cat","forEach","data_c","cat","values","v1","push","isHovering","setIsHovering","hoverCat","setHoverCat","PieDetails","Stack","spacing","direction","dataSource","palette","title","onPointHoverChanged","point","category","isHovered","onLegendClick","customizeText","pointName","argumentField","valueField","visible","enabled","ConfigPage","conf","setConf","console","log","put","headers","responseType","language","height","options","theme","Home","useLocation","history","useHistory","query_args","fromEntries","URLSearchParams","slider_value","setSliderValue","ajax_data","setData","ajax_query","current_range","sx","borderBottom","borderColor","Tabs","Tab","App","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.02afee7d.chunk.js","sourcesContent":["// import * as React from 'react';\nimport React, { useState } from 'react';\nimport Box from '@mui/material/Box';\nimport Slider from '@mui/material/Slider';\nimport Stack from '@mui/material/Stack';\nimport Tabs from '@mui/material/Tabs';\nimport Tab from '@mui/material/Tab';\nimport Typography from '@mui/material/Typography';\nimport axios from 'axios'\n// import logo from './logo.svg';\n\nimport PieChart, {\n    Series,\n    Label,\n    Legend,\n    Connector,\n    Size,\n    Export\n  } from 'devextreme-react/pie-chart';\n  \n\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Link,\n    useLocation,\n    useHistory\n} from \"react-router-dom\";\n\nimport MonacoEditor from '@uiw/react-monacoeditor';\n\n// import { JsonEditor as Editor } from 'jsoneditor-react';\n// import Ajv from 'ajv';\n// import ace from 'brace';\n// import 'brace/mode/json';\n// import 'brace/theme/github';\n// import JSONInput from 'react-json-editor-ajrm';\n// import locale    from 'react-json-editor-ajrm/locale/en';\n// CSS\nimport './App.css';\nimport 'devextreme/dist/css/dx.light.css';\n// import 'jsoneditor-react/es/editor.min.css';\n\n\nconst { DateTime } = require(\"luxon\");\n// const ajv = new Ajv({ allErrors: true, verbose: true });\n\nconst DATE_FORMAT = \"dd.LL.yyyy\"\n\nfunction valuetext(value) {\n    return DateTime.now().minus({ days: -value }).toFormat(DATE_FORMAT);\n    // return new Date(new Date().setDate(new Date().getDate() + parseInt(value))).toDateString();\n}\n\nfunction MinimumDistanceSlider(props) {\n\n    const minDistance = 1;\n\n    // const [value2, setValue2] = React.useState([-30, 0]);\n    const [value, setValue] = [props.value, props.setValue]\n\n    // transform from date string to relative days\n    const value2 = value.map(_date => {\n        if (_date != null) {\n            return Math.round(DateTime.fromFormat(_date, DATE_FORMAT).diff(DateTime.now().startOf('day'), 'days').as('days'));\n        } else {\n            return 0;\n        }\n    });\n    // console.log(\"value\",value);\n    // transform from relative days to date str\n    const setValue2 = function (days) {\n        setValue(days.map(day => valuetext(day)));\n    };\n\n    const [marks, setMarks] = React.useState([]);\n\n\n    React.useEffect(() => {\n        const fetchData = async () => {\n            const result = await axios(\"/ranges\");\n            setMarks(result.data.ranges.map(d => {\n                return {\n                    value: d,\n                    label: valuetext(d)\n                }\n            }));\n        };\n        fetchData();\n    }, []);\n\n    const handleChange2 = (event, newValue, activeThumb) => {\n        if (!Array.isArray(newValue)) {\n            return;\n        }\n\n        if (Math.abs(newValue[1] - newValue[0]) < minDistance) {\n            if (activeThumb === 0) {\n                const clamped = Math.min(newValue[0], 0 - minDistance);\n                setValue2([clamped, clamped + minDistance]);\n            } else {\n                const clamped = Math.max(newValue[1], -124 + minDistance);\n                setValue2([clamped - minDistance, clamped]);\n            }\n        } else {\n            setValue2(newValue);\n        }\n    };\n\n    return (\n        <Slider\n            getAriaLabel={() => 'Minimum distance shift'}\n            value={value2}\n            min={-124}\n            max={0}\n            marks={marks}\n            onChange={handleChange2}\n            onChangeCommitted={props.onChangeCommitted}\n            valueLabelDisplay=\"on\"\n            valueLabelFormat={valuetext}\n            disableSwap\n        />\n    );\n}\n\nfunction ByDayTable(props) {\n    // const [data, setData] = React.useState([]);\n\n    // React.useEffect(() => {\n    //     if (!('spd_rows' in props.data)) {\n    //         return;\n    //     }\n    //     console.log(props.data)\n    //     // setData(props.data['spd_rows']);\n    //   }, [props.data]);\n\n    // const data = props.data['spd_rows']\n    return (\n        <table className=\"cart\">\n            <thead>\n                <tr>\n                    {['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].map((h, inx) =>\n                        <td key={inx}>{h}</td>\n                    )}\n                </tr>\n            </thead>\n\n            <tbody>\n                {props.data['spd_rows'] && props.data['spd_rows'].map((row, r_inx) =>\n                    <tr key={r_inx}>\n                        {row.map((r, c_inx) => {\n                            const [d, v, com] = r\n                            if (d == null) {\n                                return <td key={c_inx} />\n                            } else {\n                                return (\n                                    <td key={c_inx} className=\"hasTooltip\">{d} <br />{v}\n                                        {com != null && <span className=\"tooltip\" dangerouslySetInnerHTML={{ __html: com }} />}\n                                    </td>\n                                )\n                            }\n                        })}\n                    </tr>\n                )\n                }\n            </tbody>\n        </table>\n    );\n}\n\nfunction zip_longest() {\n    var args = [].slice.call(arguments);\n    var longest = args.reduce(function (a, b) {\n        return a.length > b.length ? a : b\n    }, []);\n\n    return longest.map(function (_, i) {\n        return args.map(function (array) { return array[i] })\n    });\n}\n\nfunction SummaryTable(props) {\n    const data = props.data;\n    return (\n        <table className=\"cart\">\n            <thead>\n                <tr>\n                    {data['headers'] && data['headers'].map((h, inx) => {\n                        return <td key={inx}>{h}</td>\n                    })}\n                </tr>\n            </thead>\n\n            <tbody>\n                {data['rows'] && zip_longest(data['rows'], data['_com']).map((row_row_c, inx_r) => {\n                    const [row, row_c] = row_row_c\n                    return (\n                        <tr key={inx_r}>\n                            {zip_longest(row, row_c != null ? row_c : []).map((v_com, c_inx) => {\n                                const [v, com] = v_com\n                                return (\n                                    <td key={c_inx} className=\"hasTooltip\">{v}\n                                        {com != null && <span className=\"tooltip\" dangerouslySetInnerHTML={{ __html: com }} />}\n                                    </td>\n                                )\n                            })}\n                        </tr>\n                    )\n                })}\n            </tbody>\n        </table>\n    )\n}\n\nfunction NavTable(props) {\n    const data = props.data;\n\n    const onLinkClick = (e) => {\n        if (props.onLinkClick != null) {\n            props.onLinkClick(e.target.search);\n        }\n    };\n\n    return (\n        <table width=\"100%\">\n            <tbody>\n                <tr>\n                    <td> <Link to={\"?after=\" + data['prev_after'] + \"&before=\" + data['prev_before']} onClick={onLinkClick}>Prev Period {data['prev_after']} - {data['prev_before']}</Link> </td>\n                </tr>\n                <tr>\n                    <td> <Link to={\"?after=\" + data['next_after'] + \"&before=\" + data['next_before']} onClick={onLinkClick}>Next Period {data['next_after']} - {data['next_before']}</Link> </td>\n                </tr>\n                <tr>\n                    <td> <Link to=\"/\" onClick={onLinkClick}>Last Period</Link> </td>\n                </tr>\n                <tr>\n                    <td> <Link to=\"/upload\" onClick={(e) => { window.location.href = e.target.href }}>Upload</Link> </td>\n                </tr>\n            </tbody>\n        </table>\n    )\n}\n\n\nfunction TabPanel(props) {\n    const { children, value, index, ...other } = props;\n  \n    return (\n      <div\n        role=\"tabpanel\"\n        hidden={value !== index}\n        id={`simple-tabpanel-${index}`}\n        aria-labelledby={`simple-tab-${index}`}\n        {...other}\n      >\n        {value === index && (\n          <Box>\n            {children}\n          </Box>\n        )}\n      </div>\n    );\n  }\n  \n//   TabPanel.propTypes = {\n//     children: PropTypes.node,\n//     index: PropTypes.number.isRequired,\n//     value: PropTypes.number.isRequired,\n//   };\n  \n  function a11yProps(index) {\n    return {\n      id: `simple-tab-${index}`,\n      'aria-controls': `simple-tabpanel-${index}`,\n    };\n  }\n\n//   const useMousePosition = () => {\n//     const [position, setPosition] = React.useState({\n//       clientX: 0,\n//       clientY: 0,\n//     });\n  \n//     const updatePosition = event => {\n//       const { pageX, pageY, clientX, clientY } = event;\n  \n//       setPosition({\n//         clientX,\n//         clientY,\n//       });\n//     };\n  \n//     React.useEffect(() => {\n//       document.addEventListener(\"mousemove\", updatePosition, false);\n//       document.addEventListener(\"mouseenter\", updatePosition, false);\n  \n//       return () => {\n//         document.removeEventListener(\"mousemove\", updatePosition);\n//         document.removeEventListener(\"mouseenter\", updatePosition);\n//       };\n//     }, []);\n  \n//     return position;\n//   };\n  \n  \nfunction PieChartPage(props) {\n    // if (props.data == null || !('by_acc_cur' in props.data)) {\n    //     return null\n    // }\n    \n    const data = Object.entries(props.data['by_acc_cur'])\n        .filter(([_, v]) => {\n            return \"total\" in v;\n\n        }).map(([k, v]) => {\n            // console.log(k, v['total']);\n            return {\n                \"category\": k,\n                \"total\" : parseFloat(v['total'])\n            }\n        });\n\n    let data_by_cat = {}\n    data.forEach((e) => {\n        data_by_cat[e['category']] = e['total'];\n    })\n    let data_c = {}\n    Object.entries(props.data['by_acc_cur_c']).forEach(([cat,v]) => {\n        Object.values(v).forEach((v1) => {\n            if (!(cat in data_c)) {\n                data_c[cat] = [v1]\n            } else {\n                data_c[cat].push(v1)\n            }\n        })\n    })\n\n    const [isHovering, setIsHovering] = useState(false);\n    const [hoverCat, setHoverCat] = useState(null);\n\n    const PieDetails = () => {\n        return (\n            <Stack spacing={2}>\n                <span>{hoverCat}</span>\n                <span dangerouslySetInnerHTML={{ __html: data_c[hoverCat] }} />\n            </Stack>\n        );\n    };\n        \n    \n    const onPointHoverChanged = (e) => {\n        const point = e.target;\n        const cat = point.data.category;\n        setHoverCat(cat);        \n        setIsHovering(point.isHovered());\n    }\n\n    const onLegendClick = (e) => {\n        const point = e.target;\n        const cat = point;\n        setHoverCat(cat);        \n        setIsHovering(true);\n    }\n\n    const customizeLegendText = (e) => {\n        return e.pointName + ' ' + data_by_cat[e.pointName]\n    }\n\n    return (\n    <Stack direction=\"row\" spacing={1}>\n        <PieChart\n            id=\"pie\"\n            dataSource={data}\n            palette=\"Bright\"\n            title=\"Expenses\"\n            onPointHoverChanged={onPointHoverChanged}\n            onLegendClick={onLegendClick}\n        >\n            <Legend\n                customizeText={customizeLegendText}\n            />\n            <Series\n            argumentField=\"category\"\n            valueField=\"total\"\n            >\n            <Label visible={true}>\n                <Connector visible={true} width={1} />\n            </Label>\n            </Series>\n\n            <Size width={500} />\n            <Export enabled={false} />\n        </PieChart>\n        {isHovering && <PieDetails />}\n      </Stack>\n    )\n}\n\nfunction ConfigPage() {\n    const [conf, setConf] = useState(\"\");\n    \n    const handleChange = (e) => {\n        console.log(\"new config\", e);\n        // setConf(e);\n        const config = {\n            headers: {\n                'Content-Type': 'text/plain'\n            },\n           responseType: 'text'\n        };        \n        axios.put('/conf', e, config);\n    }\n\n    React.useEffect(() => {\n        const fetchData = async () => {\n            const result = await axios(\"/conf\");\n            setConf(result.data);\n        };\n\n        fetchData();\n    }, []);\n\n\n    return (\n\n        <MonacoEditor\n            value={conf}\n            onChange={handleChange}\n            language=\"yaml\"\n            height=\"400px\"\n            options={{\n                theme: 'vs-dark',\n            }}\n        />\n    )\n}\n\nfunction Home() {\n    const location = useLocation();\n    const history = useHistory();\n\n    const query_args = Object.fromEntries(new URLSearchParams(location.search));\n    const [slider_value, setSliderValue] = React.useState([query_args['after'], query_args['before']]);\n\n    const onSliderDragStop = () => {\n        history.push(\"?after=\" + slider_value[0] + \"&before=\" + slider_value[1]);\n    }\n\n    const [ajax_data, setData] = React.useState(query_args);\n    const ajax_query = \"/query\" + location.search;\n\n    // Tabs\n    const [value, setValue] = React.useState(0);\n\n    const handleChange = (event, newValue) => {\n      setValue(newValue);\n    };\n  \n    React.useEffect(() => {\n        const fetchData = async () => {\n            const result = await axios(ajax_query);\n            setData(result.data);\n            const current_range = [result.data['after'], result.data['before']];\n            setSliderValue(current_range);\n        };\n\n        fetchData();\n    }, [ajax_query]);\n\n    return (\n        <Stack spacing={3}>\n            <center>Summary {ajax_data['after']} - {ajax_data['before']}</center>\n            <Stack direction=\"row\" spacing={1}>\n                <Box width={600}>\n                    <NavTable data={ajax_data} />\n                </Box>\n                <MinimumDistanceSlider value={slider_value} setValue={setSliderValue} onChangeCommitted={onSliderDragStop} />\n                <Box sx={{ width: 100 }} />\n            </Stack>\n            <Box sx={{ width: '100%' }}>\n                <Box sx={{ borderBottom: 1, borderColor: 'divider' }}>\n                    <Tabs value={value} onChange={handleChange} aria-label=\"basic tabs example\">\n                    <Tab label=\"Calendar\" {...a11yProps(0)} />\n                    <Tab label=\"Summary\" {...a11yProps(1)} />\n                    <Tab label=\"Pie Chart\" {...a11yProps(2)} />\n                    <Tab label=\"Config\" {...a11yProps(3)} />\n                    </Tabs>\n                </Box>\n                <TabPanel value={value} index={0}>\n                    <ByDayTable data={ajax_data} />\n                </TabPanel>\n                <TabPanel value={value} index={1}>\n                    <SummaryTable data={ajax_data} />\n                </TabPanel>\n                <TabPanel value={value} index={2}>\n                    <PieChartPage data={ajax_data}/>\n                </TabPanel>\n                <TabPanel value={value} index={3}>\n                    <ConfigPage/>\n                </TabPanel>\n            </Box>\n        </Stack>\n    );\n}\n\nfunction App() {\n    return (\n        <Router>\n            <Switch>\n                <Route path=\"/\">\n                    <Home />\n                </Route>\n            </Switch>\n        </Router>\n    );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}